def notifyObj
node{
    env.WORKSPACE=pwd()
    try{
        stage("Checkout"){
           dir("ossim-rpm-dependencies"){
              git branch: "${OSSIM_GIT_BRANCH}", url: "${GIT_PUBLIC_SERVER_URL}/ossim-rpm-dependencies.git"
           }
           dir("ossim-ci"){
              git branch: "${OSSIM_GIT_BRANCH}", url: "${GIT_PUBLIC_SERVER_URL}/ossim-ci.git"
           }
           notifyObj = load "${env.WORKSPACE}/ossim-ci/jenkins/pipeline/notify.groovy"
        }
        stage ("Build")
        {
            sh "${env.WORKSPACE}/ossim-rpm-dependencies/scripts/rpmbuild-dependencies.sh"
        }
        stage("Archive"){

            archiveArtifacts 'dependency-rpms.tgz'
        }
        stage("Clean Workspace"){
            step([$class: 'WsCleanup'])
        }

    }
    catch(e)
    {
        currentBuild.result = "FAILED"
        notifyObj?.notifyFailed()
    }
}
